{"version":3,"file":"withIsAuthenticated.js","sources":["../../src/higherOrderComponents/withIsAuthenticated.tsx"],"sourcesContent":["/**\n * @author Arkadip Bhattacharya <in2arkadipb13@gmail.com>\n * @fileoverview Authentication status <Higher Order Component>\n * @copyright Arkadip Bhattacharya 2020\n *\n * Copyright 2020 Arkadip Bhattacharya\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *         http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from 'react';\nimport {AuthContextConsumer} from '../AuthContext';\nimport {doSignOut} from '../utils/reducers';\n\n/**\n * @interface withAuthHeaderProps\n */\ninterface withAuthHeaderProps {\n    isAuth: string\n}\n\n/**\n * @public\n * @function\n * @name withIsAuthenticated\n * @description Inject Authentication status inside the Component's Prop\n * @param Component\n */\nfunction withIsAuthenticated<P extends withAuthHeaderProps>(\n    Component: React.ComponentType<P>,\n): React.FunctionComponent<P> {\n  return (props) => {\n    return (\n      <AuthContextConsumer>\n        {(c) => {\n          if (c === null) {\n            throw new\n            Error('Auth Provider is missing. ' +\n              'Please add the AuthProvider before Router');\n          }\n          if (c.authState.auth) {\n            if (new Date(c.authState.auth.expiresAt) > new Date()) {\n              return <Component {...props} isAuth={true}/>;\n            } else {\n              c.dispatch(doSignOut());\n              return <Component {...props} isAuth={false}/>;\n            }\n          } else {\n            return <Component {...props} isAuth={false}/>;\n          }\n        }}\n      </AuthContextConsumer>\n    );\n  };\n}\n\nexport default withIsAuthenticated;\n"],"names":[],"mappings":";;;;;AAAA;;;;;;;;;;;;;;;;;;AAkBG;AAaH;;;;;;AAMG;AACH,SAAS,mBAAmB,CACxB,SAAiC,EAAA;AAEnC,IAAA,OAAO,UAAC,KAAK,EAAA;AACX,QAAA,QACE,KAAA,CAAA,aAAA,CAAC,mBAAmB,EAAA,IAAA,EACjB,UAAC,CAAC,EAAA;YACD,IAAI,CAAC,KAAK,IAAI,EAAE;gBACd,MAAM,IACN,KAAK,CAAC,4BAA4B;AAChC,oBAAA,2CAA2C,CAAC,CAAC;AAChD,aAAA;AACD,YAAA,IAAI,CAAC,CAAC,SAAS,CAAC,IAAI,EAAE;AACpB,gBAAA,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,EAAE;oBACrD,OAAO,KAAA,CAAA,aAAA,CAAC,SAAS,EAAK,QAAA,CAAA,EAAA,EAAA,KAAK,IAAE,MAAM,EAAE,IAAI,EAAA,CAAA,CAAG,CAAC;AAC9C,iBAAA;AAAM,qBAAA;AACL,oBAAA,CAAC,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC;oBACxB,OAAO,KAAA,CAAA,aAAA,CAAC,SAAS,EAAK,QAAA,CAAA,EAAA,EAAA,KAAK,IAAE,MAAM,EAAE,KAAK,EAAA,CAAA,CAAG,CAAC;AAC/C,iBAAA;AACF,aAAA;AAAM,iBAAA;gBACL,OAAO,KAAA,CAAA,aAAA,CAAC,SAAS,EAAK,QAAA,CAAA,EAAA,EAAA,KAAK,IAAE,MAAM,EAAE,KAAK,EAAA,CAAA,CAAG,CAAC;AAC/C,aAAA;SACF,CACmB,EACtB;AACJ,KAAC,CAAC;AACJ;;;;"}